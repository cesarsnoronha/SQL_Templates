-- EXERCICIOS 02

-- 1. CONTA A QUANTIDADE DE PEDIDOS E AGRUPE POR CIDADE (UTILIZE AS TABELAS ORDERS E CUSTOMERS)

SELECT CLIENTES.CUSTOMER_CITY
       ,COUNT(*) AS 'QUANTIDADE'
FROM ORDERS ORDENS

INNER JOIN CUSTOMERS CLIENTES
ON ORDENS.CUSTOMER_ID = CLIENTES.CUSTOMER_ID

GROUP BY CUSTOMER_CITY
ORDER BY 2 DESC;


-- 2. SELECTIONE O ID DO PEDIDO, O STATUS, O ID DO CLIENTE, A CIDADE DO CLIENTE E O ESTADO MESMO QUE ESTE NÃO ESTEJA PRESENTE NA TABELA CUSTOMER

SELECT ORDERS.ORDER_ID   ---ID do PEDIDO (ORDERS.ORDER_ID)
       ,ORDERS.ORDER_STATUS   ---Status (ORDERS.ORDER_STATUS)
       ,CUSTOMERS.CUSTOMER_ID  ---ID do CLIENTE (CUSTOMER.CUSTOMER_ID)
       ,CUSTOMERS.CUSTOMER_CITY   ---CIDADE do CLIENTE (CUSTOMER.CUSTOMER_CITY)
       ,CUSTOMERS.CUSTOMER_STATE    ---ESTADO do CLIENTE (CUSTOMER.CUSTOMER_STATE)

FROM ORDERS ORDERS

LEFT JOIN CUSTOMERS CUSTOMERS
ON ORDERS.CUSTOMER_ID = CUSTOMERS.CUSTOMER_ID

ORDER BY 5 DESC;

-- 3. SELECIONE O ID DO PEDIDO, A QUANTIDADE DE FOTOS, O PREÇO, O TIPO DE PAGAMENTO E O VALOR DE PAGAMENTO DOS PRODUTOS QUE TEM MAIS DE 3 FOTOS
-- (UTILIZE AS TABELAS: PEDIDOS, PAGAMENTOS E ITENS)

SELECT ORDER_ITEMS.ORDER_ID   ---ID do PEDIDO (ORDERS.ORDER_ID)
       ,PRODUCTS.PRODUCT_PHOTOS_QTY  ---A QUANTIDADE DE FOTOS, 
       ,ORDER_ITEMS.PRICE   ---O PREÇO
       ,ORDER_PAYMENTS.PAYMENT_TYPE   ---ESTADO do CLIENTE (CUSTOMER.CUSTOMER_STATE)
       ,ORDER_PAYMENTS.PAYMENT_VALUE

FROM ORDER_ITEMS ORDER_ITEMS

INNER JOIN PRODUCTS PRODUCTS
ON ORDER_ITEMS.PRODUCT_ID = PRODUCTS.PRODUCT_ID

INNER JOIN ORDER_PAYMENTS ORDER_PAYMENTS
ON ORDER_ITEMS.ORDER_ID = ORDER_PAYMENTS.ORDER_ID

WHERE PRODUCTS.PRODUCT_PHOTOS_QTY  > 3;